<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Zubo Raku - 今日のやること</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>

<body>
  <header>
    <h1>Zubo Raku</h1>
    <p class="subtitle">できたらえらい、できなくてもえらい</p>
    <nav class="menu">
      <a href="{{ url_for('index') }}">Home</a>
      <a href="{{ url_for('todo') }}" class="active">Todo</a>
      <a href="{{ url_for('log') }}">Log</a>
      <a href="{{ url_for('edit') }}">Edit</a>
      <a href="{{ url_for('register') }}">Register</a>
    </nav>
  </header>

  <main class="todo-main">
    <h2>今日のやること</h2>
    <p class="date-text">{{ today }}</p>

    {% for category, tasks in grouped_tasks.items() %}
    <section class="category-card">
      <h3>🧹 {{ category }}</h3>
      <div class="task-list">
        {% for t in tasks %}
        <div class="task-card" onclick="openModal('{{ t.subtask }}')">
          <span class="task-name">{{ t.subtask }}</span>
        </div>
        {% endfor %}
      </div>
    </section>
    {% endfor %}
  </main>

  <!-- モーダル -->
  <div id="taskModal" class="modal">
    <div class="modal-content">
      <h2 id="modalTaskName"></h2>
      <p>どうしますか？</p>
      <div class="modal-buttons">
        <button class="btn-done">✅ 完了</button>
        <button class="btn-defer">➡ あすへ</button>
        <button class="btn-skip">✖ スキップ</button>
      </div>
      <button class="modal-close" onclick="closeModal()">キャンセル</button>
    </div>
  </div>

  <script>
    const modal = document.getElementById('taskModal');
    const modalTaskName = document.getElementById('modalTaskName');

    function openModal(taskName) {
      modalTaskName.textContent = taskName;
      modal.classList.add('show');
    }

    function closeModal() {
      modal.classList.remove('show');
    }

    // 背景クリックでも閉じる
    window.onclick = function(event) {
      if (event.target === modal) {
        closeModal();
      }
    };
  </script>
</body>
</html>
